defaultTasks 'all'

project.ext {
  projName = "xtensis-core"
  version = '0.1.1'
  targetDir = 'target'
}

task clean(type: Delete) {
  logger.info('Cleaning up..')
  
  delete(project.targetDir)

  doLast {
    println("Flushed away old files..")
  }
}

task build(type: Exec) {
  logger.info("Building Xtensis Core..")
  logger.info("(This is a Debug build.)")

  commandLine('cargo', 'build')
}

task build_rel(type: Exec) {
  logger.info("Building Xtensis Core..")
  logger.info("(This is a Release build.)")

  commandLine('cargo', 'build', '--release')
}

task test(type: Exec) {
  logger.info('Testing with Cargo...')

  commandLine('cargo', 'test')
}

task docs(type: Exec) {
  logger.info("Generating documentation..")

  commandLine('cargo', 'doc')

  workingDir './doc/sphinx'
  commandLine('make', 'html')
  commandLine('make', 'info')
}

task all(dependsOn: [build, test, docs]) {
  println("Running ALL tasks for Xtensis..")
}
